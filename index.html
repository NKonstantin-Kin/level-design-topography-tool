<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8">
  <title>Level Designer Tool</title>
  <style>
    body { margin: 0; font-family: Arial; }
    .tabs { display: flex; background: #f0f0f0; padding: 8px; }
    .tab { padding: 8px 16px; margin-right: 4px; cursor: pointer; }
    .tab.active { background: #ddd; }
    #toolbar { width: 200px; height: 100vh; float: left; background: #eee; }
    #sheet { margin-left: 200px; border: 1px solid #ccc; }
  </style>
</head>
<body>
  <div class="tabs">
    <button class="tab active" onclick="switchSheet(0)">Лист 1</button>
    <button class="tab" onclick="addSheet()">+ Новый лист</button>
  </div>
  <div id="toolbar">
    <!-- Инструменты будут здесь -->
  </div>
  <canvas id="sheet" width="1600" height="1200"></canvas>

  <script>
let sheets = [];
let currentSheet = 0;
let gridEnabled = true; // Сетка включена по умолчанию
let snapToGrid = true;  // Привязка к точкам сетки
let gridStep = 20;     // Шаг сетки
let scale = 1;         // Масштаб

// Инициализация холста
const canvas = document.getElementById('sheet');
const ctx = canvas.getContext('2d');
canvas.width = 1600;
canvas.height = 1200;

// Отрисовка сетки
function drawGrid() {
  if (!gridEnabled) return;
  
  ctx.strokeStyle = '#ddd'; // Цвет сетки
  ctx.lineWidth = 1;
  
  // Вертикальные линии
  for (let x = 0; x < canvas.width; x += gridStep) {
    ctx.beginPath();
    ctx.moveTo(x, 0);
    ctx.lineTo(x, canvas.height);
    ctx.stroke();
  }
  
  // Горизонтальные линии
  for (let y = 0; y < canvas.height; y += gridStep) {
    ctx.beginPath();
    ctx.moveTo(0, y);
    ctx.lineTo(canvas.width, y);
    ctx.stroke();
  }
}

// Обновление отображения холста
function renderSheet() {
  ctx.clearRect(0, 0, canvas.width, canvas.height);
  drawGrid();
  // Здесь позже будет отрисовка элементов листа
}

// Создание вкладки для листа
function createTab(index) {
  const tab = document.createElement('button');
  tab.className = 'tab';
  tab.textContent = `Лист ${index + 1}`;
  tab.onclick = () => switchSheet(index);
  return tab;
}

// Переключение между листами
function switchSheet(index) {
  currentSheet = index;
  document.querySelectorAll('.tab').forEach(tab => tab.classList.remove('active'));
  document.querySelectorAll('.tab')[index].classList.add('active');
  renderSheet();
}

// Добавление нового листа
function addSheet() {
  if (sheets.length >= 5) return alert('Максимум 5 листов!'); // Ограничение
  sheets.push({ elements: [] });
  const tabs = document.querySelector('.tabs');
  tabs.insertBefore(createTab(sheets.length - 1), tabs.lastChild);
  switchSheet(sheets.length - 1);
}

// Добавляем кнопки для управления сеткой в #toolbar
document.getElementById('toolbar').innerHTML += `
  <button onclick="gridEnabled=!gridEnabled; renderSheet()">
    ${gridEnabled ? 'Выключить сетку' : 'Включить сетку'}
  </button>
  <button onclick="snapToGrid=!snapToGrid">
    Привязка: ${snapToGrid ? 'Вкл' : 'Выкл'}
  </button>
  <input type="number" value="${gridStep}" onchange="gridStep=parseInt(this.value); renderSheet()" min="10">
`;

// Инициализация первого листа
addSheet();
renderSheet();
  </script>
</body>
</html>
