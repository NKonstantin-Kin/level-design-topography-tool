<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Level Design Tool</title>
  <style>
    body { margin: 0; font-family: Arial; }
    #toolbar { background: #f0f0f0; padding: 10px; display: flex; gap: 10px; }
    #canvas-container { display: flex; }
    #sheets-panel { width: 200px; background: #e0e0e0; padding: 10px; }
    #canvas { border: 1px solid #000; cursor: crosshair; position: relative; }
    button.active { background: #0078d7; color: white; }
    .transform-rect { position: absolute; border: 2px dashed #0078d7; background: rgba(0,120,215,0.1); cursor: move; }
    .resize-handle { width: 8px; height: 8px; background: white; border: 1px solid #0078d7; position: absolute; }
  </style>
</head>
<body>
  <div id="toolbar">
    <button id="add-sheet">+</button>
    <button id="grid-toggle">Grid: OFF</button>
    <button id="line-btn">Line</button>
    <button id="rect-btn">Rect</button>
    <button id="add-rect-btn">Add Rect</button>
    <input type="color" id="color-picker" value="#000000">
    <input type="range" id="line-width" min="1" max="10" value="2">
  </div>
  <div id="canvas-container">
    <div id="sheets-panel">
      <ul id="sheets-list"></ul>
    </div>
    <div id="canvas"></div>
  </div>
  <script>
// Базовые переменные
let sheets = [];
let currentSheetIndex = -1;
let isDrawing = false;
let currentTool = 'line';
let gridEnabled = false;

// Инициализация листов
document.getElementById('add-sheet').addEventListener('click', function() {
  const sheetName = prompt("Название листа:", "Лист " + (sheets.length + 1));
  if (sheetName) {
    sheets.push({ name: sheetName, shapes: [] });
    updateSheetsList();
  }
});

function updateSheetsList() {
  const list = document.getElementById('sheets-list');
  list.innerHTML = '';
  sheets.forEach((sheet, index) => {
    const li = document.createElement('li');
    li.textContent = sheet.name;
    li.addEventListener('click', () => selectSheet(index));
    list.appendChild(li);
  });
}
function selectSheet(index) {
  currentSheetIndex = index;
  redrawCanvas();
}

function toggleGrid() {
  gridEnabled = !gridEnabled;
  document.getElementById('grid-toggle').textContent = gridEnabled ? 'Grid: ON' : 'Grid: OFF';
  redrawCanvas();
}

document.getElementById('grid-toggle').addEventListener('click', toggleGrid);
    function setTool(tool) {
  currentTool = tool;
  document.querySelectorAll('#toolbar button').forEach(btn => btn.classList.remove('active'));
  document.getElementById(`${tool}-btn`).classList.add('active');
}

document.getElementById('line-btn').addEventListener('click', () => setTool('line'));
document.getElementById('rect-btn').addEventListener('click', () => setTool('rect'));
// Переменные для прямоугольников
let selectedRect = null;
let isDragging = false;
let startX, startY;

// Создание прямоугольника
document.getElementById('add-rect-btn').addEventListener('click', function() {
  const rect = document.createElement('div');
  rect.className = 'transform-rect';
  rect.style.width = '150px';
  rect.style.height = '100px';
  rect.style.left = '50px';
  rect.style.top = '50px';
  
  // Добавляем точки трансформации
  addResizeHandles(rect);
  
  // Перетаскивание
  rect.addEventListener('mousedown', startDrag);
  document.getElementById('canvas').appendChild(rect);
});
function addResizeHandles(shape) {
  const positions = [
    { left: '0%', top: '0%', cursor: 'nwse-resize' }, // top-left
    { left: '50%', top: '0%', cursor: 'ns-resize' },   // top-middle
    { left: '100%', top: '0%', cursor: 'nesw-resize' } // top-right
    // ... остальные точки
  ];

  positions.forEach((pos, index) => {
    const handle = document.createElement('div');
    handle.className = 'resize-handle';
    handle.style.left = pos.left;
    handle.style.top = pos.top;
    handle.style.cursor = pos.cursor;
    handle.addEventListener('mousedown', (e) => startResize(e, index));
    shape.appendChild(handle);
  });
}
function startDrag(e) {
  if (e.target.classList.contains('transform-rect')) {
    e.stopPropagation();
    selectedRect = e.currentTarget;
    isDragging = true;
    startX = e.clientX - selectedRect.offsetLeft;
    startY = e.clientY - selectedRect.offsetTop;
    document.addEventListener('mousemove', drag);
    document.addEventListener('mouseup', stopDrag);
  }
}

function drag(e) {
  if (!isDragging) return;
  selectedRect.style.left = (e.clientX - startX) + 'px';
  selectedRect.style.top = (e.clientY - startY) + 'px';
}
function stopDrag() {
  isDragging = false;
  document.removeEventListener('mousemove', drag);
  document.removeEventListener('mouseup', stopDrag);
}

function redrawCanvas() {
  // Ваша текущая реализация
}
// Инициализация при загрузке
window.addEventListener('load', function() {
  updateSheetsList();
});
</script>
</body>
</html>
